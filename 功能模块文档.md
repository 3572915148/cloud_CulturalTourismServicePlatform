# 景德镇文旅服务平台 - 功能模块详细文档

## 项目概述

景德镇文旅服务平台是一个基于SpringBoot + Vue3的智能文旅推荐服务平台，集成DeepSeek AI推荐功能，为用户提供个性化的景德镇文化旅游服务体验。平台采用前后端分离架构，支持用户端、商户端和管理员端三种角色，实现了完整的文旅服务生态闭环。

### 核心价值
- **智能化推荐**：基于AI技术的个性化文旅产品推荐
- **全流程服务**：从产品浏览到订单完成的全链路服务
- **多角色支持**：用户、商户、管理员三方协同
- **文化传承**：深度展示景德镇陶瓷文化内涵

## 技术架构

### 后端技术栈
- **SpringBoot 3.1.5** - 核心框架，提供RESTful API服务
- **Spring Security** - 安全认证框架，JWT Token认证
- **MyBatis Plus 3.5.3.2** - 数据持久化框架，简化CRUD操作
- **MySQL 8.0** - 关系型数据库，存储业务数据
- **JWT 0.11.5** - 无状态Token认证机制
- **DeepSeek AI** - 智能推荐引擎，提供个性化推荐
- **Fastjson2 2.0.43** - JSON序列化框架
- **Maven** - 项目构建和依赖管理

### 前端技术栈
- **Vue 3.3.4** - 渐进式JavaScript框架，Composition API
- **Vite 5.0.4** - 现代化构建工具，快速热重载
- **Element Plus 2.4.4** - Vue 3 UI组件库
- **Vue Router 4.2.5** - 官方路由管理
- **Pinia 2.1.7** - 状态管理库
- **Axios 1.6.2** - HTTP客户端，API请求封装
- **Sass 1.69.5** - CSS预处理器

### 系统架构特点
- **前后端分离**：RESTful API + SPA架构
- **微服务准备**：模块化设计，便于后续微服务拆分
- **响应式设计**：支持PC端和移动端适配
- **安全机制**：JWT认证 + 权限控制

## 功能模块详述

### 1. 用户端功能模块

#### 1.1 用户认证模块 ✅

**功能概述**：提供完整的用户身份认证和个人信息管理功能

**核心功能**：
- **用户注册**：
  - 支持用户名、密码、昵称、手机号、邮箱注册
  - 密码强度验证（最少6位）
  - 用户名唯一性校验
  - 手机号格式验证
  - 密码BCrypt加密存储

- **用户登录**：
  - JWT Token认证机制
  - 支持记住登录状态（7天有效期）
  - 登录失败次数限制
  - 账户状态检查（正常/禁用）

- **个人信息管理**：
  - 查看和编辑个人资料
  - 头像上传（支持JPG/PNG格式，最大10MB）
  - 个人信息字段：昵称、邮箱、手机号、性别、生日、个人简介
  - 实时保存和验证

- **密码管理**：
  - 修改密码（需验证原密码）
  - 账号注销（软删除）
  - 密码重置功能

**技术实现**：
- 后端：`UserController`、`UserService`、`JwtUtil`、`PasswordUtil`
- 前端：`Login.vue`、`Register.vue`、`User.vue`
- 数据库：`user`表，支持逻辑删除
- 安全：BCrypt密码加密，JWT Token认证

**API接口**：
```
POST /api/user/register - 用户注册
POST /api/user/login - 用户登录
GET /api/user/info - 获取当前用户信息
PUT /api/user/update - 更新用户信息
PUT /api/user/password - 修改密码
DELETE /api/user/delete - 注销账号
```

#### 1.2 产品浏览模块 ✅

**功能概述**：提供丰富的产品浏览、搜索和筛选功能

**核心功能**：
- **首页展示**：
  - Banner轮播图（5秒自动切换）
  - 热门分类导航（景点门票、酒店住宿、特色餐饮、文化体验、陶瓷购物）
  - 推荐产品展示（评分排序）
  - AI助手入口（登录用户可见）
  - 商户入驻入口

- **产品列表**：
  - 分页展示（默认10条/页）
  - 多维度筛选：分类筛选、区域筛选、价格区间、评分筛选
  - 排序功能：价格升序/降序、评分降序、销量降序、最新上架
  - 搜索功能：关键词搜索、模糊匹配
  - 产品卡片展示：封面图、标题、价格、评分、销量、区域

- **产品详情**：
  - 产品基本信息：标题、描述、价格、库存、销量
  - 图片展示：封面图、详情图片（支持多图轮播）
  - 位置信息：区域、详细地址、经纬度
  - 产品特色：标签展示、特色描述
  - 预订须知：注意事项、使用说明
  - 用户评价：评价列表、评分统计
  - 立即预订：选择数量、填写联系信息

- **产品分类**：
  - 一级分类：景点门票、酒店住宿、特色餐饮、文化体验、陶瓷购物
  - 分类图标：使用Element Plus图标库
  - 分类统计：显示每个分类下的产品数量

**技术实现**：
- 后端：`ProductController`、`ProductService`、`ProductCategoryService`
- 前端：`Home.vue`、`Products.vue`、`ProductDetail.vue`
- 数据库：`product`表、`product_category`表
- 搜索：MyBatis Plus条件构造器实现动态查询

**API接口**：
```
GET /api/product/list - 获取产品列表（支持分页、筛选、排序）
GET /api/product/{id} - 获取产品详情
GET /api/product/category/list - 获取产品分类列表
GET /api/product/search - 产品搜索
```

#### 1.3 AI智能推荐模块 ✅

**功能概述**：基于DeepSeek AI的智能推荐系统，提供个性化文旅产品推荐

**核心功能**：
- **AI对话界面**：
  - 流式对话体验（SSE技术）
  - 实时响应显示，打字机效果
  - 对话历史记录
  - 新建会话功能
  - 推荐历史侧边栏

- **智能推荐**：
  - 基于用户查询内容智能分析
  - 结合产品数据库进行匹配推荐
  - 考虑价格、位置、评分等因素
  - 生成个性化推荐理由
  - 支持上下文理解

- **推荐历史**：
  - 查看历史推荐记录
  - 按时间排序显示
  - 显示推荐查询内容和时间
  - 反馈状态显示（有用/无用）

- **反馈机制**：
  - 对推荐结果进行有用/无用反馈
  - 反馈数据用于优化推荐算法
  - 实时更新反馈状态

- **DeepSeek集成**：
  - 使用DeepSeek Chat API
  - 支持流式和非流式两种模式
  - 错误处理和降级方案
  - API调用超时控制（50秒）

**技术实现**：
- 后端：`AiRecommendationController`、`AiRecommendationService`
- 前端：`AiChat.vue`、`ai.js` API
- AI服务：DeepSeek API集成
- 数据库：`ai_recommendation`表存储推荐记录
- 流式技术：SSE（Server-Sent Events）

**API接口**：
```
POST /api/ai/recommend - 获取AI推荐（非流式）
POST /api/ai/recommend/stream - 获取AI推荐（流式SSE）
GET /api/ai/history - 获取推荐历史
POST /api/ai/feedback - 提交推荐反馈
GET /api/ai/stats - 获取推荐统计
```

#### 1.4 订单管理模块 ✅

**功能概述**：完整的订单生命周期管理，从创建到完成的全流程处理

**核心功能**：
- **订单创建**：
  - 选择产品、数量、预订日期
  - 填写联系人信息（姓名、电话）
  - 添加备注信息
  - 自动计算总金额
  - 生成唯一订单号
  - 库存检查和扣减

- **订单支付**：
  - 模拟支付功能（一键支付）
  - 支付状态更新
  - 支付时间记录
  - 销量统计更新

- **订单查询**：
  - 我的订单列表
  - 按状态筛选（待支付、已支付、已完成、已取消）
  - 订单详情查看
  - 订单状态实时更新

- **订单管理**：
  - 取消订单（待支付状态）
  - 完成订单（已支付状态）
  - 订单状态流转管理
  - 订单操作日志

- **订单状态**：
  - 待支付（0）：订单创建后等待支付
  - 已支付（1）：支付完成，等待使用
  - 已完成（2）：服务完成，可评价
  - 已取消（3）：订单取消
  - 已退款（4）：退款完成

**技术实现**：
- 后端：`OrdersController`、`OrdersService`
- 前端：`ProductDetail.vue`预订功能、`User.vue`订单管理
- 数据库：`orders`表，支持状态流转
- 业务逻辑：库存管理、销量统计、状态控制

**API接口**：
```
POST /api/order/create - 创建订单
POST /api/order/pay/{orderId} - 支付订单
GET /api/order/{orderId} - 获取订单详情
GET /api/order/list - 获取我的订单列表
POST /api/order/{orderId}/cancel - 取消订单
POST /api/order/{orderId}/finish - 完成订单
```

#### 1.5 评价反馈模块 ✅

**功能概述**：用户评价和反馈系统，支持产品评价和系统反馈

**核心功能**：
- **产品评价**：
  - 对已完成订单的产品进行评价
  - 1-5星评分系统
  - 评价内容输入（支持富文本）
  - 评价图片上传（最多9张）
  - 评价时间记录

- **评价管理**：
  - 查看自己的评价记录
  - 评价状态显示
  - 商户回复查看
  - 评价编辑功能

- **反馈系统**：
  - 功能建议提交
  - 问题反馈提交
  - 投诉建议提交
  - 反馈图片上传
  - 联系方式填写

- **反馈历史**：
  - 查看反馈处理状态
  - 反馈类型分类
  - 处理进度跟踪
  - 回复内容查看

**技术实现**：
- 后端：`ReviewController`、`FeedbackController`
- 前端：`ProductDetail.vue`评价功能、`User.vue`反馈管理
- 数据库：`review`表、`feedback`表
- 文件上传：支持图片上传和存储

**API接口**：
```
POST /api/review/create - 创建评价
GET /api/review/list - 获取我的评价列表
POST /api/feedback/create - 提交反馈
GET /api/feedback/list - 获取反馈历史
```

#### 1.6 收藏功能模块 ✅

**功能概述**：产品收藏功能，用户可以收藏感兴趣的产品

**核心功能**：
- **产品收藏**：
  - 一键收藏/取消收藏
  - 收藏状态实时更新
  - 收藏数量统计
  - 防重复收藏机制

- **收藏管理**：
  - 收藏列表查看
  - 按分类筛选收藏
  - 收藏时间排序
  - 批量取消收藏

- **收藏状态**：
  - 实时同步收藏状态
  - 收藏按钮状态切换
  - 收藏数量显示

**技术实现**：
- 后端：`FavoriteController`、`FavoriteService`
- 前端：`ProductDetail.vue`、`User.vue`收藏管理
- 数据库：`favorite`表，用户-产品关联
- 业务逻辑：防重复收藏、状态同步

**API接口**：
```
POST /api/favorite/add - 添加收藏
DELETE /api/favorite/remove - 取消收藏
GET /api/favorite/list - 获取收藏列表
GET /api/favorite/check - 检查收藏状态
```

#### 1.7 陶瓷文化模块 ✅

**功能概述**：景德镇陶瓷文化展示模块，深度展示陶瓷文化内涵

**核心功能**：
- **文化内容展示**：
  - 陶瓷历史介绍
  - 传统工艺展示
  - 名家大师介绍
  - 经典作品展示
  - 文化传承故事

- **内容分类浏览**：
  - 按分类查看文化内容
  - 分类标签导航
  - 内容数量统计
  - 分类筛选功能

- **内容详情**：
  - 富文本内容展示
  - 高清图片展示
  - 视频内容支持
  - 作者信息显示
  - 发布时间记录

- **内容互动**：
  - 浏览量统计
  - 点赞功能
  - 内容分享
  - 评论功能（预留）

**技术实现**：
- 后端：`CeramicContentController`、`CeramicContentService`
- 前端：`Ceramic.vue`文化展示页面
- 数据库：`ceramic_content`表
- 内容管理：支持富文本、图片、视频

**API接口**：
```
GET /api/ceramic/list - 获取文化内容列表
GET /api/ceramic/{id} - 获取内容详情
GET /api/ceramic/categories - 获取内容分类
POST /api/ceramic/{id}/like - 点赞内容
```

### 2. 商户端功能模块

#### 2.1 商户认证模块 ✅

**功能概述**：商户入驻和认证管理系统，支持商户注册、审核和管理

**核心功能**：
- **商户注册**：
  - 店铺基本信息：店铺名称、Logo、店铺介绍
  - 联系人信息：联系人姓名、电话、邮箱
  - 店铺地址：详细地址信息
  - 资质文件上传：营业执照、身份证正反面
  - 信息验证：店铺名称唯一性、联系方式验证

- **商户登录**：
  - 独立的商户登录系统
  - JWT Token认证（商户专用）
  - 登录状态管理
  - 账户状态检查

- **审核状态管理**：
  - 待审核（0）：新注册商户等待审核
  - 审核通过（1）：审核通过，可正常使用
  - 审核拒绝（2）：审核被拒绝，需要重新提交
  - 审核备注：管理员审核意见

- **店铺信息管理**：
  - 编辑店铺基本信息
  - Logo上传和更新
  - 店铺介绍编辑
  - 联系信息更新

**技术实现**：
- 后端：`MerchantController`、`MerchantService`
- 前端：`MerchantLogin.vue`、`MerchantRegister.vue`、`ShopInfo.vue`
- 数据库：`merchant`表，支持审核状态管理
- 文件上传：支持营业执照、身份证等文件上传

**API接口**：
```
POST /api/merchant/register - 商户注册
POST /api/merchant/login - 商户登录
GET /api/merchant/info - 获取商户信息
PUT /api/merchant/update - 更新商户信息
```

#### 2.2 产品管理模块 ✅

**功能概述**：商户产品全生命周期管理，从发布到下架的完整流程

**核心功能**：
- **产品发布**：
  - 产品基本信息：标题、描述、价格、库存
  - 产品图片：封面图、详情图片（支持多图上传）
  - 产品分类：选择产品分类
  - 位置信息：区域、详细地址、经纬度
  - 产品特色：标签设置、特色描述
  - 预订须知：注意事项、使用说明

- **产品编辑**：
  - 修改产品信息
  - 更新产品图片
  - 调整价格和库存
  - 修改产品状态
  - 批量操作功能

- **产品状态管理**：
  - 上架（1）：产品正常销售
  - 下架（0）：产品暂停销售
  - 推荐状态：设置推荐产品
  - 库存管理：实时库存更新

- **产品分类管理**：
  - 选择产品分类
  - 分类标签设置
  - 产品标签管理

**技术实现**：
- 后端：`MerchantProductController`、`ProductService`
- 前端：`ProductManage.vue`产品管理页面
- 数据库：`product`表，关联商户ID
- 文件管理：产品图片上传和管理

**API接口**：
```
GET /api/merchant/products - 获取我的产品列表
POST /api/merchant/products - 发布新产品
PUT /api/merchant/products/{id} - 更新产品信息
DELETE /api/merchant/products/{id} - 删除产品
POST /api/merchant/products/{id}/status - 更新产品状态
```

#### 2.3 订单管理模块 ✅

**功能概述**：商户订单处理和管理系统，支持订单查看、处理和统计

**核心功能**：
- **订单查看**：
  - 所有订单列表
  - 按状态筛选（待支付、已支付、已完成、已取消）
  - 按时间范围筛选
  - 订单详情查看
  - 订单搜索（订单号、联系电话）

- **订单处理**：
  - 确认订单（标记为已支付）
  - 处理订单状态变更
  - 订单备注添加
  - 订单操作日志

- **订单统计**：
  - 订单数量统计
  - 订单金额统计
  - 订单状态分布
  - 时间维度统计

- **订单搜索**：
  - 按订单号搜索
  - 按联系电话搜索
  - 按客户姓名搜索
  - 高级搜索功能

**技术实现**：
- 后端：`MerchantOrderController`、`MerchantOrderService`
- 前端：`OrderManage.vue`订单管理页面
- 数据库：`orders`表，按商户ID筛选
- 业务逻辑：订单状态流转、统计计算

**API接口**：
```
GET /api/merchant/orders - 获取商户订单列表
GET /api/merchant/orders/{id} - 获取订单详情
POST /api/merchant/orders/{id}/confirm - 确认订单
POST /api/merchant/orders/{id}/status - 更新订单状态
GET /api/merchant/orders/stats - 获取订单统计
```

#### 2.4 评价管理模块 ✅

**功能概述**：用户评价查看和回复管理系统

**核心功能**：
- **评价查看**：
  - 查看用户对产品的评价
  - 按产品筛选评价
  - 按评分筛选评价
  - 评价详情查看
  - 评价图片查看

- **评价回复**：
  - 对用户评价进行回复
  - 回复内容编辑
  - 回复时间记录
  - 回复状态管理

- **评价统计**：
  - 评价数量统计
  - 平均评分计算
  - 评分分布统计
  - 回复率统计

**技术实现**：
- 后端：`MerchantReviewController`、`ReviewService`
- 前端：`ReviewManage.vue`评价管理页面
- 数据库：`review`表，按商户ID筛选
- 业务逻辑：评价统计、回复管理

**API接口**：
```
GET /api/merchant/reviews - 获取商户评价列表
POST /api/merchant/review/{id}/reply - 回复评价
GET /api/merchant/reviews/stats - 获取评价统计
```

#### 2.5 商户工作台 ✅

**功能概述**：商户数据概览和快捷操作中心

**核心功能**：
- **数据概览**：
  - 订单统计：今日订单、本月订单、总订单
  - 评价统计：总评价数、平均评分、待回复评价
  - 产品统计：总产品数、上架产品、下架产品
  - 收入统计：今日收入、本月收入、总收入

- **快捷操作**：
  - 快速访问产品管理
  - 快速访问订单管理
  - 快速访问评价管理
  - 快速访问店铺信息

- **状态展示**：
  - 审核状态显示
  - 店铺状态展示
  - 系统通知显示
  - 待处理事项提醒

**技术实现**：
- 后端：`MerchantService`统计数据计算
- 前端：`Dashboard.vue`工作台页面
- 数据库：多表关联查询统计
- 业务逻辑：实时数据统计

**API接口**：
```
GET /api/merchant/dashboard - 获取工作台数据
GET /api/merchant/stats - 获取统计数据
```

### 3. 管理员端功能模块

#### 3.1 商户审核模块 ✅

**功能概述**：商户审核和管理系统，支持商户审核、状态管理

**核心功能**：
- **商户列表**：
  - 查看所有商户信息
  - 按审核状态筛选（待审核、已通过、已拒绝）
  - 按注册时间排序
  - 商户详情查看
  - 分页展示

- **审核操作**：
  - 审核通过：设置审核状态为通过
  - 审核拒绝：设置审核状态为拒绝
  - 审核备注：添加审核意见和说明
  - 审核时间记录

- **状态管理**：
  - 启用商户账户
  - 禁用商户账户
  - 状态变更记录
  - 批量状态操作

**技术实现**：
- 后端：`AdminMerchantAuditController`、`MerchantService`
- 前端：管理员后台（待完善）
- 数据库：`merchant`表审核状态管理
- 业务逻辑：审核流程控制

**API接口**：
```
GET /api/admin/merchant/list - 获取商户列表
POST /api/admin/merchant/{id}/approve - 审核通过
POST /api/admin/merchant/{id}/reject - 审核拒绝
POST /api/admin/merchant/{id}/status - 更新商户状态
```

#### 3.2 管理员认证模块 ⚠️

**功能概述**：管理员身份认证和权限管理系统

**当前状态**：
- **管理员登录**：基础登录页面（前端实现）
- **权限管理**：未实现完整的权限控制
- **管理员管理**：未实现管理员CRUD功能

**待完善功能**：
- 管理员注册和创建
- 角色权限管理
- 操作日志记录
- 系统配置管理

**技术实现**：
- 后端：管理员相关API（待实现）
- 前端：`AdminLogin.vue`（基础实现）
- 数据库：`admin`表（已设计）
- 安全：权限控制（待实现）

### 4. 系统功能模块

#### 4.1 文件管理模块 ✅

**功能概述**：统一的文件上传、存储和访问管理系统

**核心功能**：
- **文件上传**：
  - 支持图片上传（JPG、PNG格式）
  - 支持文档上传（PDF、DOC等）
  - 文件大小限制（最大10MB）
  - 文件类型验证
  - 上传进度显示

- **文件存储**：
  - 本地文件存储
  - 文件路径管理
  - 文件重命名（UUID）
  - 存储目录结构

- **文件访问**：
  - 文件URL生成
  - 文件访问接口
  - 文件下载功能
  - 文件预览功能

**技术实现**：
- 后端：`FileController`、文件上传处理
- 前端：文件上传组件
- 存储：本地文件系统
- 配置：文件上传配置

**API接口**：
```
POST /api/file/upload - 文件上传
GET /api/file/{filename} - 文件访问
DELETE /api/file/{filename} - 文件删除
```

#### 4.2 数据管理模块 ✅

**功能概述**：数据库设计和数据初始化管理系统

**核心功能**：
- **数据库设计**：
  - 11个核心业务表
  - 完整的表结构设计
  - 索引优化
  - 外键关联

- **数据初始化**：
  - 基础数据插入脚本
  - 产品分类初始化
  - 管理员账号初始化
  - 测试数据插入

- **逻辑删除**：
  - 支持软删除功能
  - 数据恢复功能
  - 删除状态管理

**技术实现**：
- 数据库：MySQL 8.0
- 脚本：`schema.sql`、测试数据脚本
- 框架：MyBatis Plus逻辑删除
- 工具：数据库管理工具

#### 4.3 异常处理模块 ✅

**功能概述**：全局异常处理和错误响应管理系统

**核心功能**：
- **全局异常处理**：
  - 统一异常捕获
  - 异常分类处理
  - 错误日志记录
  - 异常堆栈跟踪

- **业务异常**：
  - 自定义业务异常类
  - 异常码定义
  - 异常消息国际化
  - 异常上下文信息

- **错误响应**：
  - 标准化错误响应格式
  - HTTP状态码映射
  - 错误信息封装
  - 客户端友好提示

**技术实现**：
- 后端：`GlobalExceptionHandler`、`BusinessException`
- 前端：统一错误处理
- 日志：异常日志记录
- 响应：标准化错误响应

## 未完成功能模块

### 1. 后端未完成功能

#### 1.1 Redis缓存功能 ❌

**功能描述**：高性能缓存系统，提升数据访问速度

**当前状态**：
- Maven依赖已注释（spring-boot-starter-data-redis）
- 配置文件已注释（Redis连接配置）
- 缓存注解未使用

**影响分析**：
- 数据库查询压力大
- 响应速度较慢
- 并发性能受限

**建议实现**：
- 启用Redis缓存依赖
- 配置Redis连接信息
- 实现缓存策略：
  - 产品信息缓存（30分钟）
  - 用户信息缓存（15分钟）
  - 分类数据缓存（1小时）
  - AI推荐结果缓存（10分钟）

**技术方案**：
```java
@Cacheable(value = "products", key = "#id")
public Product getProductById(Long id) { ... }

@CacheEvict(value = "products", key = "#product.id")
public void updateProduct(Product product) { ... }
```

#### 1.2 管理员完整功能 ❌

**功能描述**：完整的管理员权限管理系统

**当前状态**：
- 只有基础的商户审核功能
- 缺少管理员CRUD操作
- 权限控制不完善

**待实现功能**：
- **管理员管理**：
  - 管理员账号创建
  - 管理员信息编辑
  - 管理员状态管理
  - 管理员删除

- **权限控制**：
  - 基于角色的权限控制（RBAC）
  - 菜单权限管理
  - 操作权限控制
  - 数据权限隔离

- **系统管理**：
  - 系统配置管理
  - 操作日志记录
  - 数据备份恢复
  - 系统监控

**技术方案**：
```java
@PreAuthorize("hasRole('ADMIN')")
@PostMapping("/admin/create")
public Result<AdminVO> createAdmin(@RequestBody AdminCreateDTO dto) { ... }
```

#### 1.3 支付集成 ❌

**功能描述**：真实支付系统集成

**当前状态**：
- 只有模拟支付功能
- 支付状态简单更新
- 缺少支付回调处理

**待实现功能**：
- **支付渠道**：
  - 支付宝支付集成
  - 微信支付集成
  - 银联支付集成
  - 支付方式选择

- **支付流程**：
  - 支付订单创建
  - 支付参数生成
  - 支付回调处理
  - 支付状态同步

- **退款功能**：
  - 退款申请处理
  - 退款状态跟踪
  - 退款金额计算
  - 退款通知

**技术方案**：
```java
@Service
public class PaymentService {
    public PaymentResult createPayment(Order order) { ... }
    public void handlePaymentCallback(PaymentCallback callback) { ... }
    public RefundResult processRefund(RefundRequest request) { ... }
}
```

#### 1.4 消息通知 ❌

**功能描述**：多渠道消息通知系统

**待实现功能**：
- **邮件通知**：
  - 订单确认邮件
  - 支付成功通知
  - 评价提醒邮件
  - 系统通知邮件

- **短信通知**：
  - 验证码发送
  - 订单状态通知
  - 重要操作提醒
  - 营销短信

- **站内消息**：
  - 系统公告
  - 个人消息
  - 通知中心
  - 消息推送

**技术方案**：
```java
@Service
public class NotificationService {
    public void sendEmail(String to, String subject, String content) { ... }
    public void sendSms(String phone, String content) { ... }
    public void sendInAppMessage(Long userId, String content) { ... }
}
```

#### 1.5 数据统计 ❌

**功能描述**：业务数据统计和分析系统

**待实现功能**：
- **业务统计**：
  - 用户注册统计
  - 订单数据统计
  - 收入统计
  - 产品销量统计

- **报表功能**：
  - 日报、周报、月报
  - 数据导出（Excel、PDF）
  - 图表展示
  - 趋势分析

- **数据分析**：
  - 用户行为分析
  - 产品热度分析
  - 收入趋势分析
  - 转化率分析

### 2. 前端未完成功能

#### 2.1 移动端优化 ❌

**功能描述**：移动端用户体验优化

**当前状态**：
- 部分页面有基础响应式设计
- 移动端适配不够完善
- 触摸交互体验待优化

**待实现功能**：
- **响应式设计**：
  - 完善移动端布局
  - 优化触摸交互
  - 适配不同屏幕尺寸
  - 移动端导航优化

- **PWA支持**：
  - Service Worker实现
  - 离线缓存功能
  - 推送通知
  - 应用安装提示

- **性能优化**：
  - 图片懒加载
  - 代码分割
  - 缓存策略
  - 加载优化

#### 2.2 管理员后台 ❌

**功能描述**：完整的管理员后台界面

**当前状态**：
- 只有登录页面
- 缺少管理功能界面
- 数据管理功能缺失

**待实现功能**：
- **管理后台页面**：
  - 数据概览仪表板
  - 用户管理界面
  - 商户管理界面
  - 产品管理界面
  - 订单管理界面

- **数据管理界面**：
  - 数据表格展示
  - 数据筛选和搜索
  - 批量操作功能
  - 数据导出功能

- **系统配置**：
  - 系统参数配置
  - 邮件配置
  - 支付配置
  - 缓存配置

#### 2.3 高级功能 ❌

**功能描述**：高级功能和用户体验提升

**待实现功能**：
- **地图集成**：
  - 产品位置展示
  - 路线规划
  - 附近产品推荐
  - 地图搜索

- **实时通信**：
  - WebSocket连接
  - 实时消息推送
  - 在线客服
  - 实时通知

- **多语言支持**：
  - 国际化配置
  - 中英文切换
  - 语言包管理
  - 动态语言加载

### 3. 系统集成未完成功能

#### 3.1 第三方集成 ❌

**功能描述**：第三方服务集成

**待实现功能**：
- **微信登录**：
  - 微信OAuth2.0授权
  - 微信用户信息获取
  - 微信分享功能
  - 微信支付集成

- **支付宝支付**：
  - 支付宝SDK集成
  - 支付参数配置
  - 支付回调处理
  - 退款功能

- **地图API**：
  - 高德地图集成
  - 百度地图集成
  - 位置服务
  - 地理编码

#### 3.2 部署相关 ❌

**功能描述**：生产环境部署和运维

**待实现功能**：
- **Docker容器化**：
  - Dockerfile编写
  - Docker Compose配置
  - 容器编排
  - 镜像管理

- **CI/CD**：
  - GitHub Actions配置
  - 自动化测试
  - 自动化部署
  - 版本管理

- **监控告警**：
  - 应用性能监控
  - 系统资源监控
  - 错误日志监控
  - 告警通知

## 数据库设计

### 数据库架构

**数据库类型**：MySQL 8.0
**字符集**：utf8mb4
**排序规则**：utf8mb4_unicode_ci
**存储引擎**：InnoDB

### 核心数据表设计

#### 1. 用户表 (user)
```sql
CREATE TABLE `user` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '用户ID',
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `password` VARCHAR(255) NOT NULL COMMENT '密码（BCrypt加密）',
    `nickname` VARCHAR(50) COMMENT '昵称',
    `email` VARCHAR(100) COMMENT '邮箱',
    `phone` VARCHAR(20) COMMENT '手机号',
    `avatar` VARCHAR(255) COMMENT '头像URL',
    `gender` TINYINT DEFAULT 0 COMMENT '性别：0-未知，1-男，2-女',
    `birthday` DATE COMMENT '生日',
    `introduction` TEXT COMMENT '个人简介',
    `status` TINYINT DEFAULT 1 COMMENT '账户状态：0-禁用，1-正常',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_username (`username`),
    INDEX idx_phone (`phone`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
```

#### 2. 商户表 (merchant)
```sql
CREATE TABLE `merchant` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '商户ID',
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '商户账号',
    `password` VARCHAR(255) NOT NULL COMMENT '密码（BCrypt加密）',
    `shop_name` VARCHAR(100) NOT NULL COMMENT '店铺名称',
    `shop_logo` VARCHAR(255) COMMENT '店铺Logo',
    `shop_introduction` TEXT COMMENT '店铺介绍',
    `contact_person` VARCHAR(50) COMMENT '联系人',
    `contact_phone` VARCHAR(20) COMMENT '联系电话',
    `contact_email` VARCHAR(100) COMMENT '联系邮箱',
    `address` VARCHAR(255) COMMENT '店铺地址',
    `business_license` VARCHAR(255) COMMENT '营业执照URL',
    `id_card_front` VARCHAR(255) COMMENT '身份证正面URL',
    `id_card_back` VARCHAR(255) COMMENT '身份证背面URL',
    `audit_status` TINYINT DEFAULT 0 COMMENT '审核状态：0-待审核，1-审核通过，2-审核拒绝',
    `audit_remark` VARCHAR(255) COMMENT '审核备注',
    `status` TINYINT DEFAULT 1 COMMENT '账户状态：0-禁用，1-正常',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_shop_name (`shop_name`),
    INDEX idx_audit_status (`audit_status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商户表';
```

#### 3. 产品分类表 (product_category)
```sql
CREATE TABLE `product_category` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '分类ID',
    `name` VARCHAR(50) NOT NULL COMMENT '分类名称',
    `parent_id` BIGINT DEFAULT 0 COMMENT '父分类ID，0表示顶级分类',
    `sort_order` INT DEFAULT 0 COMMENT '排序',
    `icon` VARCHAR(255) COMMENT '图标',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_parent_id (`parent_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='产品分类表';
```

#### 4. 产品表 (product)
```sql
CREATE TABLE `product` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '产品ID',
    `merchant_id` BIGINT NOT NULL COMMENT '商户ID',
    `category_id` BIGINT NOT NULL COMMENT '分类ID',
    `title` VARCHAR(200) NOT NULL COMMENT '产品标题',
    `description` TEXT COMMENT '产品描述',
    `cover_image` VARCHAR(255) COMMENT '封面图片',
    `images` TEXT COMMENT '产品图片（JSON数组）',
    `price` DECIMAL(10, 2) DEFAULT 0.00 COMMENT '价格',
    `original_price` DECIMAL(10, 2) COMMENT '原价',
    `stock` INT DEFAULT 0 COMMENT '库存',
    `sales` INT DEFAULT 0 COMMENT '销量',
    `region` VARCHAR(100) COMMENT '所在区域',
    `address` VARCHAR(255) COMMENT '详细地址',
    `latitude` DECIMAL(10, 7) COMMENT '纬度',
    `longitude` DECIMAL(10, 7) COMMENT '经度',
    `rating` DECIMAL(2, 1) DEFAULT 5.0 COMMENT '评分',
    `tags` VARCHAR(255) COMMENT '标签（JSON数组）',
    `features` TEXT COMMENT '产品特色',
    `notice` TEXT COMMENT '预订须知',
    `status` TINYINT DEFAULT 1 COMMENT '状态：0-下架，1-上架',
    `recommend` TINYINT DEFAULT 0 COMMENT '是否推荐：0-否，1-是',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_merchant_id (`merchant_id`),
    INDEX idx_category_id (`category_id`),
    INDEX idx_region (`region`),
    INDEX idx_status (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='产品表';
```

#### 5. 订单表 (orders)
```sql
CREATE TABLE `orders` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '订单ID',
    `order_no` VARCHAR(32) NOT NULL UNIQUE COMMENT '订单号',
    `user_id` BIGINT NOT NULL COMMENT '用户ID',
    `merchant_id` BIGINT NOT NULL COMMENT '商户ID',
    `product_id` BIGINT NOT NULL COMMENT '产品ID',
    `product_title` VARCHAR(200) COMMENT '产品标题快照',
    `product_image` VARCHAR(255) COMMENT '产品图片快照',
    `price` DECIMAL(10, 2) NOT NULL COMMENT '单价',
    `quantity` INT DEFAULT 1 COMMENT '数量',
    `total_amount` DECIMAL(10, 2) NOT NULL COMMENT '总金额',
    `booking_date` DATE COMMENT '预订日期',
    `booking_time` VARCHAR(50) COMMENT '预订时间段',
    `contact_name` VARCHAR(50) COMMENT '联系人姓名',
    `contact_phone` VARCHAR(20) COMMENT '联系电话',
    `remark` TEXT COMMENT '备注',
    `status` TINYINT DEFAULT 0 COMMENT '订单状态：0-待支付，1-已支付，2-已完成，3-已取消，4-已退款',
    `pay_time` DATETIME COMMENT '支付时间',
    `complete_time` DATETIME COMMENT '完成时间',
    `cancel_time` DATETIME COMMENT '取消时间',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_order_no (`order_no`),
    INDEX idx_user_id (`user_id`),
    INDEX idx_merchant_id (`merchant_id`),
    INDEX idx_status (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='订单表';
```

#### 6. 评价表 (review)
```sql
CREATE TABLE `review` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '评价ID',
    `order_id` BIGINT NOT NULL COMMENT '订单ID',
    `user_id` BIGINT NOT NULL COMMENT '用户ID',
    `product_id` BIGINT NOT NULL COMMENT '产品ID',
    `merchant_id` BIGINT NOT NULL COMMENT '商户ID',
    `rating` TINYINT NOT NULL COMMENT '评分：1-5星',
    `content` TEXT COMMENT '评价内容',
    `images` TEXT COMMENT '评价图片（JSON数组）',
    `reply_content` TEXT COMMENT '商户回复内容',
    `reply_time` DATETIME COMMENT '回复时间',
    `status` TINYINT DEFAULT 1 COMMENT '状态：0-隐藏，1-显示',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_order_id (`order_id`),
    INDEX idx_user_id (`user_id`),
    INDEX idx_product_id (`product_id`),
    INDEX idx_merchant_id (`merchant_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='评价表';
```

#### 7. 反馈表 (feedback)
```sql
CREATE TABLE `feedback` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '反馈ID',
    `user_id` BIGINT COMMENT '用户ID（可为空，允许匿名反馈）',
    `type` TINYINT DEFAULT 1 COMMENT '反馈类型：1-功能建议，2-问题反馈，3-投诉',
    `content` TEXT NOT NULL COMMENT '反馈内容',
    `contact` VARCHAR(100) COMMENT '联系方式',
    `images` TEXT COMMENT '反馈图片（JSON数组）',
    `status` TINYINT DEFAULT 0 COMMENT '处理状态：0-待处理，1-处理中，2-已处理',
    `reply` TEXT COMMENT '回复内容',
    `reply_time` DATETIME COMMENT '回复时间',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_user_id (`user_id`),
    INDEX idx_status (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='反馈表';
```

#### 8. 陶瓷文化内容表 (ceramic_content)
```sql
CREATE TABLE `ceramic_content` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '内容ID',
    `category` VARCHAR(50) COMMENT '分类：历史、工艺、名家、作品等',
    `title` VARCHAR(200) NOT NULL COMMENT '标题',
    `summary` TEXT COMMENT '摘要',
    `content` LONGTEXT COMMENT '内容（富文本）',
    `cover_image` VARCHAR(255) COMMENT '封面图',
    `images` TEXT COMMENT '相关图片（JSON数组）',
    `video_url` VARCHAR(255) COMMENT '视频链接',
    `author` VARCHAR(50) COMMENT '作者',
    `views` INT DEFAULT 0 COMMENT '浏览量',
    `likes` INT DEFAULT 0 COMMENT '点赞数',
    `sort_order` INT DEFAULT 0 COMMENT '排序',
    `status` TINYINT DEFAULT 1 COMMENT '状态：0-下架，1-上架',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_category (`category`),
    INDEX idx_status (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='陶瓷文化内容表';
```

#### 9. AI推荐记录表 (ai_recommendation)
```sql
CREATE TABLE `ai_recommendation` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '记录ID',
    `user_id` BIGINT COMMENT '用户ID',
    `query` TEXT NOT NULL COMMENT '用户查询内容',
    `context` TEXT COMMENT '上下文信息',
    `response` TEXT COMMENT 'AI响应内容',
    `recommended_products` TEXT COMMENT '推荐的产品ID列表（JSON数组）',
    `feedback` TINYINT COMMENT '用户反馈：1-有帮助，0-没帮助',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    INDEX idx_user_id (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='AI推荐记录表';
```

#### 10. 收藏表 (favorite)
```sql
CREATE TABLE `favorite` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '收藏ID',
    `user_id` BIGINT NOT NULL COMMENT '用户ID',
    `product_id` BIGINT NOT NULL COMMENT '产品ID',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '收藏时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    UNIQUE KEY uk_user_product (`user_id`, `product_id`),
    INDEX idx_user_id (`user_id`),
    INDEX idx_product_id (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='收藏表';
```

#### 11. 管理员表 (admin)
```sql
CREATE TABLE `admin` (
    `id` BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '管理员ID',
    `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '用户名',
    `password` VARCHAR(255) NOT NULL COMMENT '密码（BCrypt加密）',
    `nickname` VARCHAR(50) COMMENT '昵称',
    `email` VARCHAR(100) COMMENT '邮箱',
    `avatar` VARCHAR(255) COMMENT '头像',
    `role` VARCHAR(50) DEFAULT 'ADMIN' COMMENT '角色',
    `status` TINYINT DEFAULT 1 COMMENT '状态：0-禁用，1-正常',
    `deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除，1-已删除',
    `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    INDEX idx_username (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='系统管理员表';
```

### 数据库设计特点

1. **完整性**：11个核心表覆盖所有业务场景
2. **扩展性**：支持逻辑删除，便于数据恢复
3. **性能优化**：合理的索引设计，提升查询效率
4. **数据安全**：密码加密存储，敏感信息保护
5. **审计功能**：创建时间、更新时间自动记录
6. **关联设计**：外键关联保证数据一致性

## 项目完成度评估

### 已完成功能（约70%）
- ✅ 用户端核心功能完整
- ✅ 商户端核心功能完整
- ✅ AI推荐功能完整
- ✅ 基础订单流程完整
- ✅ 文件上传功能完整
- ✅ 数据库设计完整

### 待完善功能（约30%）
- ❌ Redis缓存功能
- ❌ 管理员完整功能
- ❌ 真实支付集成
- ❌ 移动端优化
- ❌ 管理员后台
- ❌ 第三方集成

## 建议优化方向

1. **性能优化**：启用Redis缓存，优化数据库查询
2. **功能完善**：完善管理员功能，实现权限控制
3. **支付集成**：接入真实支付系统
4. **移动端优化**：完善响应式设计，提升移动端体验
5. **系统集成**：集成地图、微信等第三方服务
6. **部署优化**：实现Docker容器化部署

## 总结

景德镇文旅服务平台已经实现了核心的业务功能，包括用户端、商户端的主要功能模块，AI推荐功能也基本完善。项目架构清晰，代码结构良好，具备良好的扩展性。主要需要完善的是系统管理功能、性能优化和移动端适配等方面。
